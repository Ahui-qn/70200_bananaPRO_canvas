# 需求文档

## 简介

重新设计画布生成图片的交互逻辑，采用简洁、现代、工具型产品风格。移除左侧侧边栏，以底部对话框作为主要交互入口，强调"对话式生成"的体验。整体风格参考苹果公司的玻璃化设计语言。

## 术语表

- **对话框（Dialog Bar）**: 位于页面底部的主要交互组件，包含提示词输入、参考图上传、配置菜单等功能
- **模式切换按钮（Mode Switcher）**: 用于切换功能模式的按钮，默认为"生成图片"模式
- **参考图（Reference Image）**: 用户上传的用于指导 AI 生成的参考图片
- **配置卡片（Config Card）**: 展开后显示高级生成配置的浮动面板
- **画布缩放组件（Canvas Zoom Control）**: 用于控制画布缩放比例的悬浮组件

## 需求

### 需求 1

**用户故事：** 作为用户，我希望界面布局更加简洁开放，以便获得更沉浸的画布操作体验。

#### 验收标准

1. WHEN 用户进入画布页面 THEN 系统 SHALL 显示无左侧侧边栏的全屏画布布局
2. WHEN 画布页面加载完成 THEN 系统 SHALL 在页面底部居中显示对话框组件
3. WHEN 画布页面加载完成 THEN 系统 SHALL 在画布左下角显示悬浮式缩放控制组件
4. WHEN 用户操作画布 THEN 缩放控制组件 SHALL 保持悬浮状态不干扰画布主体内容

### 需求 2

**用户故事：** 作为用户，我希望底部对话框具有简洁现代的外观，以便获得愉悦的视觉体验。

#### 验收标准

1. WHEN 对话框渲染时 THEN 系统 SHALL 采用圆角、轻阴影、玻璃化毛玻璃效果的 UI 风格
2. WHEN 对话框显示时 THEN 系统 SHALL 使用半透明背景配合模糊效果实现玻璃化视觉
3. WHEN 对话框布局时 THEN 系统 SHALL 横向居中固定在页面底部，与底部保持适当间距
4. WHEN 对话框宽度计算时 THEN 系统 SHALL 采用响应式设计，最大宽度不超过 800px

### 需求 3

**用户故事：** 作为用户，我希望能够通过模式切换按钮选择不同的功能模式，以便未来使用更多功能。

#### 验收标准

1. WHEN 对话框渲染时 THEN 系统 SHALL 在最左侧显示模式切换按钮
2. WHEN 模式切换按钮显示时 THEN 系统 SHALL 默认显示"生成图片"模式图标
3. WHEN 用户点击模式切换按钮 THEN 系统 SHALL 显示可选模式列表（当前仅生成图片可用）
4. WHEN 模式切换时 THEN 系统 SHALL 为未来扩展（生成视频、ChatGPT 对话等）预留接口

### 需求 4

**用户故事：** 作为用户，我希望能够方便地上传参考图片，以便指导 AI 生成更符合预期的图片。

#### 验收标准

1. WHEN 对话框渲染时 THEN 系统 SHALL 在模式按钮右侧显示"+"按钮用于上传参考图
2. WHEN 用户点击"+"按钮 THEN 系统 SHALL 打开文件选择器允许选择本地图片
3. WHEN 用户将图片拖拽到输入框区域 THEN 系统 SHALL 识别并上传该图片作为参考图
4. WHEN 参考图上传成功 THEN 系统 SHALL 在对话框上方区域显示参考图预览

### 需求 5

**用户故事：** 作为用户，我希望能够在输入框中输入提示词，以便描述我想要生成的图片。

#### 验收标准

1. WHEN 对话框渲染时 THEN 系统 SHALL 在中间区域显示提示词输入框
2. WHEN 输入框获得焦点 THEN 系统 SHALL 显示适当的视觉反馈
3. WHEN 对话框渲染时 THEN 系统 SHALL 在最右侧显示圆形生成按钮（发送图标）
4. WHEN 用户点击生成按钮或按回车 THEN 系统 SHALL 触发图片生成流程
5. WHEN 输入框为空时触发生成 THEN 系统 SHALL 不触发生成并显示提示信息

### 需求 6

**用户故事：** 作为用户，我希望能够查看和管理已上传的参考图，以便控制生成效果。

#### 验收标准

1. WHEN 存在已上传的参考图 THEN 系统 SHALL 在对话框上方显示参考图预览区域
2. WHEN 参考图数量超出显示宽度 THEN 系统 SHALL 采用横向滑动方式展示
3. WHEN 用户点击参考图上的删除按钮 THEN 系统 SHALL 移除该参考图
4. WHEN 参考图区域显示时 THEN 系统 SHALL 不遮挡画布核心内容

### 需求 7

**用户故事：** 作为用户，我希望能够配置图片生成的高级选项，以便精细控制生成结果。

#### 验收标准

1. WHEN 对话框渲染时 THEN 系统 SHALL 在生成按钮左侧显示折叠菜单按钮（三横线图标）
2. WHEN 用户点击折叠菜单按钮 THEN 系统 SHALL 以卡片形式向上展开配置面板
3. WHEN 配置面板展开时 THEN 系统 SHALL 以菜单按钮为锚点定位，不遮挡输入框区域
4. WHEN 配置面板展开时 THEN 系统 SHALL 显示模型选择、尺寸选择、生成数量等配置项
5. WHEN 用户调整生成数量 THEN 系统 SHALL 使用滑动条组件，范围 1-6，实时显示当前值
6. WHEN 用户点击配置面板外部区域 THEN 系统 SHALL 关闭配置面板

### 需求 8

**用户故事：** 作为用户，我希望画布缩放控制组件位于左下角且不干扰操作，以便随时调整视图。

#### 验收标准

1. WHEN 画布页面加载完成 THEN 系统 SHALL 在左下角显示悬浮式缩放控制组件
2. WHEN 缩放组件渲染时 THEN 系统 SHALL 采用与对话框一致的玻璃化 UI 风格
3. WHEN 用户操作缩放组件 THEN 系统 SHALL 实时更新画布缩放比例
4. WHEN 缩放组件显示时 THEN 系统 SHALL 保持紧凑布局不占用过多空间

### 需求 9

**用户故事：** 作为用户，我希望整体交互流程流畅一体化，以便高效完成图片生成。

#### 验收标准

1. WHEN 用户完成提示词输入和配置 THEN 系统 SHALL 支持通过生成按钮或回车键触发生成
2. WHEN 图片生成中 THEN 系统 SHALL 在对话框区域显示生成进度状态
3. WHEN 图片生成中 THEN 系统 SHALL 禁用生成按钮和回车触发，防止重复提交
4. WHEN 图片生成中 THEN 系统 SHALL 显示取消按钮允许用户中断生成
5. WHEN 图片生成完成 THEN 系统 SHALL 自动将生成的图片添加到画布中
6. WHEN 生成失败 THEN 系统 SHALL 在对话框区域显示错误提示信息并恢复可操作状态


### 需求 10

**用户故事：** 作为用户，我希望新生成的图片能够自动排列在合理的位置，以便保持画布的空间秩序。

#### 验收标准

1. WHEN 触发图片生成时 THEN 系统 SHALL 以画布中最近一次生成的图片位置作为参考锚点
2. WHEN 计算新图片位置时 THEN 系统 SHALL 将新图片默认排列在上一次生成图片的下方区域
3. WHEN 计算新图片位置时 THEN 系统 SHALL 确保不与画布中已有的任何图片发生重叠
4. WHEN 上一次生成的图片已被用户手动拖动 THEN 系统 SHALL 获取其最新位置作为下一次生成的参考基准
5. WHEN 一次生成多张图片时 THEN 系统 SHALL 在生成区域内按横向顺序自动排列，保持统一间距
6. WHEN 图片实际生成之前 THEN 系统 SHALL 提前计算并预留即将生成图片所需的完整区域
7. WHEN 生成区域不在当前可视范围内 THEN 系统 SHALL 对画布视角进行平滑自动调整使其可见
