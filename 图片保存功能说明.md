# 图片保存功能使用说明

## 功能概述

本项目现已集成完整的图片保存和管理功能，支持本地存储和阿里云 OSS 云存储两种方式。

## 主要功能

### 1. 自动保存生成的图片
- 每次成功生成图片后，系统会自动保存到本地 IndexedDB 数据库
- 保存的信息包括：图片 URL、生成参数、创建时间等
- 如果配置了 OSS，会自动尝试上传到云存储

### 2. 图片库管理
- 点击右上角的"图片库"按钮打开图片管理界面
- 支持网格视图和列表视图两种显示模式
- 提供搜索、筛选、收藏等功能

### 3. 阿里云 OSS 云存储
- 点击右上角的"云存储"按钮配置 OSS 参数
- 配置完成后，新生成的图片会自动上传到 OSS
- 支持批量上传已有图片到 OSS

## 使用步骤

### 配置阿里云 OSS（可选）

1. **开通阿里云 OSS 服务**
   - 登录阿里云控制台
   - 开通对象存储 OSS 服务
   - 创建存储桶（Bucket）

2. **获取访问凭证**
   - 创建 AccessKey（建议使用子账号）
   - 确保 AccessKey 具有 OSS 读写权限

3. **在项目中配置 OSS**
   - 点击右上角"云存储"按钮
   - 填写以下信息：
     - 区域：选择你的 OSS 区域
     - 存储桶名称：你创建的 Bucket 名称
     - AccessKey ID：你的 AccessKey ID
     - AccessKey Secret：你的 AccessKey Secret
     - 自定义域名（可选）：如果配置了 CDN 域名
   - 点击"测试连接"验证配置
   - 点击"保存配置"完成设置

### 使用图片库

1. **查看已保存的图片**
   - 点击右上角"图片库"按钮
   - 浏览所有已生成和保存的图片

2. **搜索和筛选**
   - 使用搜索框按提示词或模型名搜索
   - 使用左侧筛选选项：
     - 全部图片
     - 收藏图片
     - 最近24小时
   - 按模型筛选

3. **图片操作**
   - 单击图片可选择
   - 点击爱心图标收藏/取消收藏
   - 点击下载图标下载图片
   - 点击删除图标删除图片

4. **批量操作**
   - 选择多张图片后，可以：
     - 批量下载
     - 批量上传到 OSS（如果已配置）
     - 批量删除

## 存储说明

### 本地存储
- 使用浏览器 IndexedDB 数据库
- 数据存储在本地，不会丢失
- 最多存储 1000 张图片（自动清理旧图片）

### 云存储（OSS）
- 图片上传到阿里云 OSS
- 获得永久访问链接
- 支持 CDN 加速访问
- 自动按年月分文件夹存储

## 安全提示

1. **AccessKey 安全**
   - 建议使用子账号 AccessKey
   - 定期更换 AccessKey
   - 不要在代码中硬编码 AccessKey

2. **权限控制**
   - OSS 存储桶建议设置为私有读写
   - 通过 CDN 或签名 URL 提供访问

3. **数据备份**
   - 重要图片建议同时保存到本地和云端
   - 定期导出图片库数据

## 故障排除

### OSS 上传失败
1. 检查网络连接
2. 验证 AccessKey 权限
3. 确认存储桶名称和区域正确
4. 检查浏览器控制台错误信息

### 图片加载失败
1. 检查图片 URL 是否有效
2. 确认 OSS 访问权限设置
3. 检查 CDN 配置（如果使用）

### 本地存储问题
1. 清理浏览器缓存和数据
2. 检查浏览器是否支持 IndexedDB
3. 确认存储空间充足

## 技术架构

- **前端框架**：React + TypeScript
- **本地存储**：IndexedDB
- **云存储**：阿里云 OSS
- **UI 组件**：Tailwind CSS + Lucide Icons
- **构建工具**：Vite

## 更新日志

### v1.0.0
- ✅ 自动保存生成的图片
- ✅ 本地 IndexedDB 存储
- ✅ 图片库管理界面
- ✅ 搜索和筛选功能
- ✅ 收藏和标签功能
- ✅ 阿里云 OSS 集成
- ✅ 批量操作功能
- ✅ 网格和列表视图
- ✅ 图片下载功能

---

如有问题或建议，请联系开发团队。